<html lang="zh">

<head>
    <meta charset="UTF-8">
    <title>单机游戏合集</title>
    <link rel="stylesheet" href="style.css">
    <script src="items.js"></script>
</head>

<body>
    <table class="dataintable">
        <tbody>
            <tr>
                <th>游戏名称
                    <input type="text" placeholder="搜索">
                </th>
                <th>下载地址</th>
                <th>提取码</th>
                <th>解压码</th>
            </tr>
        </tbody>
    </table>
    <script>

        let eInput = document.querySelector("input[type=text]");
        let eTable = document.querySelector(".dataintable>tbody");

        let search = "";
        empty_table_content();
        fill_data_into_table();

        eInput.addEventListener("input", function (event) {
            search = eInput.value;
            empty_table_content();
            fill_data_into_table();
        });

        function empty_table_content() {
            while (eTable.childElementCount > 1) {
                eTable.removeChild(eTable.lastElementChild);
            }
        }

        function fill_data_into_table() {
            for (let item of items) {
                if (item[2].indexOf(search) === -1) continue;
                let game = new Game(item);
                let eTr = document.createElement("tr");
                eTr.innerHTML = (
                    `<td>${game.name}</td>` +
                    `<td><a href="${game.link}" target="_blank">${game.link}</a></td>` +
                    `<td>${game.code}</td>` +
                    `<td>${game.pswd}</td>` + `\n`
                );
                eTable.appendChild(eTr);
            }
        }

        function Game(item) {
            this.name = item[2];
            this.link = item[0];
            this.code = (() => {
                let code = "";
                let index = this.link.lastIndexOf("#");
                if (index !== -1) {
                    code = this.link.substr(index + 1)
                }
                return code;
            })();
            this.pswd = item[1];
        }

    </script>
</body>

</html>